{extend name="index/index"}

{block name='style'}
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
<script>if (location.href.indexOf('#') > -1) location.replace(location.href.split('#')[0])</script>
<link rel="stylesheet" href="__ROOT__/static/theme/css/login.css">
{/block}

{block name="body"}
<div class="login-container" {$loginStyle|raw}>
    <div class="header notselect layui-hide-xs">
<!--        <a href="{:url('@')}" class="title">{:sysconf('app_name')}<span>{:sysconf('app_version')}</span></a>-->
        {notempty name='runtimeMode'}
<!--        <a class="pull-right layui-anim layui-anim-fadein" target="_blank" href='https://gitee.com/zoujingli/ThinkAdmin'>-->
<!--            <img src='https://gitee.com/zoujingli/ThinkAdmin/widgets/widget_1.svg' alt='Fork me on Gitee'>-->
<!--        </a>-->
        {/notempty}
    </div>
    <form data-login-form onsubmit="return false" method="post" class="layui-anim layui-anim-upbit" autocomplete="off">
        <h2 class="notselect">Recharge System</h2>
        <ul>
            <li class="username">
                <label class="label-required-null">
                    <i class="layui-icon layui-icon-username"></i>
                    <input class="layui-input" required pattern="^\S{4,}$" vali-name="username" name="username" autofocus autocomplete="off" placeholder="username">
                </label>
            </li>
            <li class="password">
                <label class="label-required-null">
                    <i class="layui-icon layui-icon-password"></i>
                    <input class="layui-input" required pattern="^\S{4,}$" vali-name="password" name="password" maxlength="32" type="password" autocomplete="off" placeholder="password" lay-affix="eye">
                </label>
            </li>
            <li class="password" style="display: none">
                <label class="label-required-null">
                    <i class="layui-icon layui-icon-password"></i>
                    <input class="layui-input" vali-name="mac_address" name="mac_address" autocomplete="off" placeholder="mac_address" lay-affix="eye">
                </label>
            </li>
            <li class="verify layui-hide">
                <label class="inline-block relative label-required-null">
                    <i class="layui-icon layui-icon-picture-fine"></i>
                    <input class="layui-input" required pattern="^\S{4,}$" name="verify" maxlength="4" autocomplete="off" vali-name="verification code" placeholder="verification code">
                </label>
                <label data-captcha="{:url('admin/login/captcha',[],false)}" data-field-verify="verify" data-field-uniqid="uniqid" data-captcha-type="{$captchaType}" data-captcha-token="{$captchaToken}"></label>
            </li>
            <li class="text-center padding-top-20">
                <button type="submit" class="layui-btn layui-disabled full-width" data-form-loaded="login">正在载入</button>
            </li>
        </ul>
    </form>
    <div class="footer notselect">
<!--        <p class="layui-hide-xs">推荐使用 <a target="_blank" href="https://www.google.cn/chrome">Google Chrome</a> 或 <a target="_blank" href="https://www.microsoft.com/zh-cn/edge#platform">Microsoft Edge</a> 浏览器访问</p>-->
        {:sysconf('site_copy')}
        {if sysconf('beian')}<span class="padding-5">|</span><a target="_blank" href="https://www.beian.gov.cn/portal/registerSystemInfo">{:sysconf('beian')}</a>{/if}
        {if sysconf('miitbeian')}<span class="padding-5">|</span><a target="_blank" href="https://beian.miit.gov.cn/">{:sysconf('miitbeian')}</a>{/if}
    </div>
</div>
{/block}

{block name='script'}
<script src="__ROOT__/static/login.js"></script>
<script>
    function getUserMacAddress(){
        const xhr = new XMLHttpRequest();
        xhr.open('GET', 'http://localhost:8080/', true);
        xhr.withCredentials = true; // 设置携带凭证
        xhr.onreadystatechange = function () {
            if (xhr.readyState === 4 && xhr.status === 200) {
                console.log(xhr.responseText);
                $('input[name="mac_address"]').val(xhr.responseText);
            }
        };
        xhr.send();
    }
    window.onload = getUserMacAddress;
</script>
{/block}